

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Testing Guidelines &#8212; NumPy v1.18.dev0 Manual</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="../_static/sphinx-bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/extra-footer.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/code-highlight.css" />
    <link href="../_static/css/custom.css" rel="stylesheet">
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Window functions" href="routines.window.html" />
    <link rel="prev" title="numpy.testing.suppress_warnings.record" href="generated/numpy.testing.suppress_warnings.record.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">

<a class="navbar-brand" href="../index.html">
  <img src="../_static/numpy_logo.png" class="logo" alt="logo">
</a>

<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<div id="navbar-menu" class="collapse navbar-collapse">
  <ul id="navbar-main-elements" class="navbar-nav mr-auto">
    <li class="nav-item">
        <a class="nav-link" href="../index.html">Home</a>
    </li>
    
    
    <li class="nav-item ">
        <a class="nav-link" href="../user/index.html">User Guide</a>
    </li>
    
    <li class="nav-item active">
        <a class="nav-link" href="index.html">NumPy Reference</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../dev/index.html">Contributing to NumPy</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../release.html">Release Notes</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../about.html">About NumPy</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href=""></a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../bugs.html">Reporting bugs</a>
    </li>
    
    <li class="nav-item ">
        <a class="nav-link" href="../glossary.html">Glossary</a>
    </li>
    
  </ul>
  <ul class="navbar-nav ml-auto">
    <li class="nav-item">
      <a class="nav-link" href="https://github.com/pandas-dev/pandas" target="_blank" rel="noopener">
        <span><i class="fab fa-github-alt" style="color:#333;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="https://twitter.com/pandas_dev" target="_blank" rel="noopener">
        <span><i class="fab fa-twitter" style="color:#55acee;font-size:1rem;line-height:1.25"></i></span>
      </a>
    </li>
  </ul>
</div>
    </nav>

    <div class="container-fluid">
      <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
              

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
        
          
              <li class="">
                  <a href="arrays.html">Array objects</a>
              </li>
          
        
          
              <li class="">
                  <a href="constants.html">Constants</a>
              </li>
          
        
          
              <li class="">
                  <a href="ufuncs.html">Universal functions (ufunc)</a>
              </li>
          
        
          
    
              <li class="active">
                  <a href="routines.html">Routines</a>
                  <ul>
                  
                      <li class="">
                          <a href="routines.array-creation.html">Array creation routines</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.array-manipulation.html">Array manipulation routines</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.bitwise.html">Binary operations</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.char.html">String operations</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.ctypeslib.html">C-Types Foreign Function Interface (numpy.ctypeslib)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.datetime.html">Datetime Support Functions</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.dtype.html">Data type routines</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.dual.html">Optionally Scipy-accelerated routines (numpy.dual)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.emath.html">Mathematical functions with automatic domain (numpy.emath)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.err.html">Floating point error handling</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.fft.html">Discrete Fourier Transform (numpy.fft)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.financial.html">Financial functions</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.functional.html">Functional programming</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.help.html">NumPy-specific help functions</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.indexing.html">Indexing routines</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.io.html">Input and output</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.linalg.html">Linear algebra (numpy.linalg)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.logic.html">Logic functions</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.ma.html">Masked array operations</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.math.html">Mathematical functions</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.matlib.html">Matrix library (numpy.matlib)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.other.html">Miscellaneous routines</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.padding.html">Padding Arrays</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.polynomials.html">Polynomials</a>
                      </li>
                  
                      <li class="">
                          <a href="random/index.html">Random sampling (numpy.random)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.set.html">Set routines</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.sort.html">Sorting, searching, and counting</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.statistics.html">Statistics</a>
                      </li>
                  
                      <li class="active">
                          <a href="routines.testing.html">Test Support (numpy.testing)</a>
                      </li>
                  
                      <li class="">
                          <a href="routines.window.html">Window functions</a>
                      </li>
                  
                  </ul>
              </li> 
          
        
          
              <li class="">
                  <a href="distutils.html">Packaging (numpy.distutils)</a>
              </li>
          
        
          
              <li class="">
                  <a href="distutils_guide.html">NumPy Distutils - Users Guide</a>
              </li>
          
        
          
              <li class="">
                  <a href="c-api/index.html">NumPy C-API</a>
              </li>
          
        
          
              <li class="">
                  <a href="internals.html">NumPy internals</a>
              </li>
          
        
          
              <li class="">
                  <a href="swig.html">NumPy and SWIG</a>
              </li>
          
        
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>

</nav>


              
          </div>

          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#introduction" class="nav-link">Introduction</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#writing-your-own-tests" class="nav-link">Writing your own tests</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#labeling-tests" class="nav-link">Labeling tests</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#easier-setup-and-teardown-functions-methods" class="nav-link">Easier setup and teardown functions / methods</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#parametric-tests" class="nav-link">Parametric tests</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#doctests" class="nav-link">Doctests</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#tests" class="nav-link">tests/</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#init-py-and-setup-py" class="nav-link">__init__.py and setup.py</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#tips-tricks" class="nav-link">Tips & Tricks</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#creating-many-similar-tests" class="nav-link">Creating many similar tests</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#known-failures-skipping-tests" class="nav-link">Known failures & skipping tests</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#tests-on-random-data" class="nav-link">Tests on random data</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>
              
            </div>

          <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
              <div>
                
  <div class="section" id="testing-guidelines">
<span id="id1"></span><h1>Testing Guidelines<a class="headerlink" href="#testing-guidelines" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Until the 1.15 release, NumPy used the <a class="reference external" href="https://nose.readthedocs.io/en/latest/">nose</a> testing framework, it now uses
the <a class="reference external" href="https://pytest.readthedocs.io">pytest</a> framework. The older framework is still maintained in order to
support downstream projects that use the old numpy framework, but all tests
for NumPy should use pytest.</p>
<p>Our goal is that every module and package in SciPy and NumPy
should have a thorough set of unit
tests. These tests should exercise the full functionality of a given
routine as well as its robustness to erroneous or unexpected input
arguments. Long experience has shown that by far the best time to
write the tests is before you write or change the code - this is
<a class="reference external" href="https://en.wikipedia.org/wiki/Test-driven_development">test-driven development</a>.  The
arguments for this can sound rather abstract, but we can assure you
that you will find that writing the tests first leads to more robust
and better designed code. Well-designed tests with good coverage make
an enormous difference to the ease of refactoring. Whenever a new bug
is found in a routine, you should write a new test for that specific
case and add it to the test suite to prevent that bug from creeping
back in unnoticed.</p>
<p>To run SciPy’s full test suite, use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
<p>or from the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python runtests.py
</pre></div>
</div>
<p>SciPy uses the testing framework from <a class="reference internal" href="routines.testing.html#module-numpy.testing" title="numpy.testing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.testing</span></code></a>, so all
the SciPy examples shown here are also applicable to NumPy.  NumPy’s full test
suite can be run as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numpy</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
<p>The test method may take two or more arguments; the first, <code class="docutils literal notranslate"><span class="pre">label</span></code> is a
string specifying what should be tested and the second, <code class="docutils literal notranslate"><span class="pre">verbose</span></code> is an
integer giving the level of output verbosity. See the docstring for
numpy.test for details.  The default value for <code class="docutils literal notranslate"><span class="pre">label</span></code> is ‘fast’ - which
will run the standard tests.  The string ‘full’ will run the full battery
of tests, including those identified as being slow to run. If <code class="docutils literal notranslate"><span class="pre">verbose</span></code>
is 1 or less, the tests will just show information messages about the tests
that are run; but if it is greater than 1, then the tests will also provide
warnings on missing tests. So if you want to run every test and get
messages about which modules don’t have tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># or scipy.test(&#39;full&#39;, 2)</span>
</pre></div>
</div>
<p>Finally, if you are only interested in testing a subset of SciPy, for
example, the <code class="docutils literal notranslate"><span class="pre">integrate</span></code> module, use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
<p>or from the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$python runtests.py -t scipy/integrate/tests
</pre></div>
</div>
<p>The rest of this page will give you a basic idea of how to add unit
tests to modules in SciPy. It is extremely important for us to have
extensive unit testing since this code is going to be used by
scientists and researchers and is being developed by a large number of
people spread across the world. So, if you are writing a package that
you’d like to become part of SciPy, please write the tests as you
develop the package. Also since much of SciPy is legacy code that was
originally written without unit tests, there are still several modules
that don’t have tests yet. Please feel free to choose one of these
modules and develop tests for it as you read through
this introduction.</p>
</div>
<div class="section" id="writing-your-own-tests">
<h2>Writing your own tests<a class="headerlink" href="#writing-your-own-tests" title="Permalink to this headline">¶</a></h2>
<p>Every Python module, extension module, or subpackage in the SciPy
package directory should have a corresponding <code class="docutils literal notranslate"><span class="pre">test_&lt;name&gt;.py</span></code> file.
Pytest examines these files for test methods (named test*) and test
classes (named Test*).</p>
<p>Suppose you have a SciPy module <code class="docutils literal notranslate"><span class="pre">scipy/xxx/yyy.py</span></code> containing a
function <code class="docutils literal notranslate"><span class="pre">zzz()</span></code>.  To test this function you would create a test
module called <code class="docutils literal notranslate"><span class="pre">test_yyy.py</span></code>.  If you only need to test one aspect of
<code class="docutils literal notranslate"><span class="pre">zzz</span></code>, you can simply add a test function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_zzz</span><span class="p">():</span>
    <span class="n">assert_</span><span class="p">(</span><span class="n">zzz</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Hello from zzz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>More often, we need to group a number of tests together, so we create
a test class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_</span><span class="p">,</span> <span class="n">assert_raises</span>

<span class="c1"># import xxx symbols</span>
<span class="kn">from</span> <span class="nn">scipy.xxx.yyy</span> <span class="kn">import</span> <span class="n">zzz</span>

<span class="k">class</span> <span class="nc">TestZzz</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">test_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">assert_</span><span class="p">(</span><span class="n">zzz</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Hello from zzz&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_invalid_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">assert_raises</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Within these test methods, <code class="docutils literal notranslate"><span class="pre">assert_()</span></code> and related functions are used to test
whether a certain assumption is valid. If the assertion fails, the test fails.
Note that the Python builtin <code class="docutils literal notranslate"><span class="pre">assert</span></code> should not be used, because it is
stripped during compilation with <code class="docutils literal notranslate"><span class="pre">-O</span></code>.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">test_</span></code> functions or methods should not have a docstring, because
that makes it hard to identify the test from the output of running the test
suite with <code class="docutils literal notranslate"><span class="pre">verbose=2</span></code> (or similar verbosity setting).  Use plain comments
(<code class="docutils literal notranslate"><span class="pre">#</span></code>) if necessary.</p>
<div class="section" id="labeling-tests">
<h3>Labeling tests<a class="headerlink" href="#labeling-tests" title="Permalink to this headline">¶</a></h3>
<p>As an alternative to <code class="docutils literal notranslate"><span class="pre">pytest.mark.&lt;label&gt;</span></code>, there are a number of labels you
can use.</p>
<p>Unlabeled tests like the ones above are run in the default
<code class="docutils literal notranslate"><span class="pre">scipy.test()</span></code> run.  If you want to label your test as slow - and
therefore reserved for a full <code class="docutils literal notranslate"><span class="pre">scipy.test(label='full')</span></code> run, you
can label it with a decorator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># numpy.testing module includes &#39;import decorators as dec&#39;</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">dec</span><span class="p">,</span> <span class="n">assert_</span>

<span class="nd">@dec</span><span class="o">.</span><span class="n">slow</span>
<span class="k">def</span> <span class="nf">test_big</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">print</span> <span class="s1">&#39;Big, slow test&#39;</span>
</pre></div>
</div>
<p>Similarly for methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">test_zzz</span><span class="p">:</span>
    <span class="nd">@dec</span><span class="o">.</span><span class="n">slow</span>
    <span class="k">def</span> <span class="nf">test_simple</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">assert_</span><span class="p">(</span><span class="n">zzz</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Hello from zzz&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Available labels are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">slow</span></code>: marks a test as taking a long time</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setastest(tf)</span></code>: work-around for test discovery when the test name is
non conformant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skipif(condition,</span> <span class="pre">msg=None)</span></code>: skips the test when <code class="docutils literal notranslate"><span class="pre">eval(condition)</span></code> is
<code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">knownfailureif(fail_cond,</span> <span class="pre">msg=None)</span></code>: will avoid running the test if
<code class="docutils literal notranslate"><span class="pre">eval(fail_cond)</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, useful for tests that conditionally segfault</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deprecated(conditional=True)</span></code>: filters deprecation warnings emitted in the
test</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">paramaterize(var,</span> <span class="pre">input)</span></code>: an alternative to
<a class="reference external" href="https://docs.pytest.org/en/latest/parametrize.html">pytest.mark.paramaterized</a></p></li>
</ul>
</div>
<div class="section" id="easier-setup-and-teardown-functions-methods">
<h3>Easier setup and teardown functions / methods<a class="headerlink" href="#easier-setup-and-teardown-functions-methods" title="Permalink to this headline">¶</a></h3>
<p>Testing looks for module-level or class-level setup and teardown functions by
name; thus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Module-level setup&quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="s1">&#39;doing setup&#39;</span>

<span class="k">def</span> <span class="nf">teardown</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Module-level teardown&quot;&quot;&quot;</span>
    <span class="nb">print</span> <span class="s1">&#39;doing teardown&#39;</span>


<span class="k">class</span> <span class="nc">TestMe</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Class-level setup&quot;&quot;&quot;</span>
        <span class="nb">print</span> <span class="s1">&#39;doing setup&#39;</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Class-level teardown&quot;&quot;&quot;</span>
        <span class="nb">print</span> <span class="s1">&#39;doing teardown&#39;</span>
</pre></div>
</div>
<p>Setup and teardown functions to functions and methods are known as “fixtures”,
and their use is not encouraged.</p>
</div>
<div class="section" id="parametric-tests">
<h3>Parametric tests<a class="headerlink" href="#parametric-tests" title="Permalink to this headline">¶</a></h3>
<p>One very nice feature of testing is allowing easy testing across a range
of parameters - a nasty problem for standard unit tests. Use the
<code class="docutils literal notranslate"><span class="pre">dec.paramaterize</span></code> decorator.</p>
</div>
<div class="section" id="doctests">
<h3>Doctests<a class="headerlink" href="#doctests" title="Permalink to this headline">¶</a></h3>
<p>Doctests are a convenient way of documenting the behavior of a function
and allowing that behavior to be tested at the same time.  The output
of an interactive Python session can be included in the docstring of a
function, and the test framework can run the example and compare the
actual output to the expected output.</p>
<p>The doctests can be run by adding the <code class="docutils literal notranslate"><span class="pre">doctests</span></code> argument to the
<code class="docutils literal notranslate"><span class="pre">test()</span></code> call; for example, to run all tests (including doctests)
for numpy.lib:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">doctests</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The doctests are run as if they are in a fresh Python instance which
has executed <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>. Tests that are part of a SciPy
subpackage will have that subpackage already imported. E.g. for a test
in <code class="docutils literal notranslate"><span class="pre">scipy/linalg/tests/</span></code>, the namespace will be created such that
<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy</span> <span class="pre">import</span> <span class="pre">linalg</span></code> has already executed.</p>
</div>
<div class="section" id="tests">
<h3><code class="docutils literal notranslate"><span class="pre">tests/</span></code><a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h3>
<p>Rather than keeping the code and the tests in the same directory, we
put all the tests for a given subpackage in a <code class="docutils literal notranslate"><span class="pre">tests/</span></code>
subdirectory. For our example, if it doesn’t already exist you will
need to create a <code class="docutils literal notranslate"><span class="pre">tests/</span></code> directory in <code class="docutils literal notranslate"><span class="pre">scipy/xxx/</span></code>. So the path
for <code class="docutils literal notranslate"><span class="pre">test_yyy.py</span></code> is <code class="docutils literal notranslate"><span class="pre">scipy/xxx/tests/test_yyy.py</span></code>.</p>
<p>Once the <code class="docutils literal notranslate"><span class="pre">scipy/xxx/tests/test_yyy.py</span></code> is written, its possible to
run the tests by going to the <code class="docutils literal notranslate"><span class="pre">tests/</span></code> directory and typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">test_yyy</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Or if you add <code class="docutils literal notranslate"><span class="pre">scipy/xxx/tests/</span></code> to the Python path, you could run
the tests interactively in the interpreter like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">test_yyy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_yyy</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="init-py-and-setup-py">
<h3><code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> and <code class="docutils literal notranslate"><span class="pre">setup.py</span></code><a class="headerlink" href="#init-py-and-setup-py" title="Permalink to this headline">¶</a></h3>
<p>Usually, however, adding the <code class="docutils literal notranslate"><span class="pre">tests/</span></code> directory to the python path
isn’t desirable. Instead it would better to invoke the test straight
from the module <code class="docutils literal notranslate"><span class="pre">xxx</span></code>. To this end, simply place the following lines
at the end of your package’s <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">Tester</span>
    <span class="k">return</span> <span class="n">Tester</span><span class="p">()</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">)</span>
</pre></div>
</div>
<p>You will also need to add the tests directory in the configuration
section of your setup.py:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="k">def</span> <span class="nf">configuration</span><span class="p">(</span><span class="n">parent_package</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">top_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">config</span><span class="o">.</span><span class="n">add_data_dir</span><span class="p">(</span><span class="s1">&#39;tests&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">config</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Now you can do the following to test your module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">xxx</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
<p>Also, when invoking the entire SciPy test suite, your tests will be
found and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
<span class="go"># your tests are included and run automatically!</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tips-tricks">
<h2>Tips &amp; Tricks<a class="headerlink" href="#tips-tricks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-many-similar-tests">
<h3>Creating many similar tests<a class="headerlink" href="#creating-many-similar-tests" title="Permalink to this headline">¶</a></h3>
<p>If you have a collection of tests that must be run multiple times with
minor variations, it can be helpful to create a base class containing
all the common tests, and then create a subclass for each variation.
Several examples of this technique exist in NumPy; below are excerpts
from one in <a class="reference external" href="https://github.com/numpy/numpy/blob/master/numpy/linalg/tests/test_linalg.py">numpy/linalg/tests/test_linalg.py</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LinalgTestCase</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">test_single</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">single</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">single</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_double</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">double</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">double</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="o">...</span>

<span class="k">class</span> <span class="nc">TestSolve</span><span class="p">(</span><span class="n">LinalgTestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">assert_</span><span class="p">(</span><span class="n">imply</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">matrix</span><span class="p">),</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)))</span>

<span class="k">class</span> <span class="nc">TestInv</span><span class="p">(</span><span class="n">LinalgTestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">a_inv</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a_inv</span><span class="p">),</span> <span class="n">identity</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">assert_</span><span class="p">(</span><span class="n">imply</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">matrix</span><span class="p">),</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_inv</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)))</span>
</pre></div>
</div>
<p>In this case, we wanted to test solving a linear algebra problem using
matrices of several data types, using <code class="docutils literal notranslate"><span class="pre">linalg.solve</span></code> and
<code class="docutils literal notranslate"><span class="pre">linalg.inv</span></code>.  The common test cases (for single-precision,
double-precision, etc. matrices) are collected in <code class="docutils literal notranslate"><span class="pre">LinalgTestCase</span></code>.</p>
</div>
<div class="section" id="known-failures-skipping-tests">
<h3>Known failures &amp; skipping tests<a class="headerlink" href="#known-failures-skipping-tests" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you might want to skip a test or mark it as a known failure,
such as when the test suite is being written before the code it’s
meant to test, or if a test only fails on a particular architecture.</p>
<p>To skip a test, simply use <code class="docutils literal notranslate"><span class="pre">skipif</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">skipif</span><span class="p">(</span><span class="n">SkipMyTest</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Skipping this test because...&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_something</span><span class="p">(</span><span class="n">foo</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The test is marked as skipped if <code class="docutils literal notranslate"><span class="pre">SkipMyTest</span></code> evaluates to nonzero,
and the message in verbose test output is the second argument given to
<code class="docutils literal notranslate"><span class="pre">skipif</span></code>.  Similarly, a test can be marked as a known failure by
using <code class="docutils literal notranslate"><span class="pre">xfail</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pytest</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">xfail</span><span class="p">(</span><span class="n">MyTestFails</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;This test is known to fail because...&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_something_else</span><span class="p">(</span><span class="n">foo</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Of course, a test can be unconditionally skipped or marked as a known
failure by using <code class="docutils literal notranslate"><span class="pre">skip</span></code> or <code class="docutils literal notranslate"><span class="pre">xfail</span></code> without argument, respectively.</p>
<p>A total of the number of skipped and known failing tests is displayed
at the end of the test run.  Skipped tests are marked as <code class="docutils literal notranslate"><span class="pre">'S'</span></code> in
the test results (or <code class="docutils literal notranslate"><span class="pre">'SKIPPED'</span></code> for <code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>), and known
failing tests are marked as <code class="docutils literal notranslate"><span class="pre">'x'</span></code> (or <code class="docutils literal notranslate"><span class="pre">'XFAIL'</span></code> if <code class="docutils literal notranslate"><span class="pre">verbose</span> <span class="pre">&gt;</span>
<span class="pre">1</span></code>).</p>
</div>
<div class="section" id="tests-on-random-data">
<h3>Tests on random data<a class="headerlink" href="#tests-on-random-data" title="Permalink to this headline">¶</a></h3>
<p>Tests on random data are good, but since test failures are meant to expose
new bugs or regressions, a test that passes most of the time but fails
occasionally with no code changes is not helpful. Make the random data
deterministic by setting the random number seed before generating it.  Use
either Python’s <code class="docutils literal notranslate"><span class="pre">random.seed(some_number)</span></code> or NumPy’s
<code class="docutils literal notranslate"><span class="pre">numpy.random.seed(some_number)</span></code>, depending on the source of random numbers.</p>
</div>
</div>
</div>


              </div>
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="generated/numpy.testing.suppress_warnings.record.html" title="previous page">numpy.testing.suppress_warnings.record</a>
    <a class='right-next' id="next-link" href="routines.window.html" title="next page">Window functions</a>

              </div>
          </main>

      </div>
    </div><script>
    // TOC sidebar - add "active" class to parent list
    //
    // Bootstrap's scrollspy adds the active class to the <a> link,
    // but for the automatic collapsing we need this on the parent list item.
    //
    // The event is triggered on "window" (and not the nav item as documented),
    // see https://github.com/twbs/bootstrap/issues/20086
    $(window).on("activate.bs.scrollspy", function(){
    var navLinks = document.querySelectorAll('#bd-toc-nav a');
    for (var i = 0; i < navLinks.length; i++) {
        var navLink = navLinks[i];
        navLink.parentElement.classList.remove('active');
    }
    var navLinks = document.querySelectorAll('#bd-toc-nav a.active');
    for (var i = 0; i < navLinks.length; i++) {
        var navLink = navLinks[i];
        navLink.parentElement.classList.add('active');
    }
    });

    /**
     * Use left and right arrow keys to navigate forward and backwards.
    */
    const LEFT_ARROW_KEYCODE = 37
    const RIGHT_ARROW_KEYCODE = 39

    const getPrevUrl = () => document.getElementById('prev-link').href
    const getNextUrl = () => document.getElementById('next-link').href
    const initPageNav = (event) => {
        const keycode = event.which

        if (keycode === LEFT_ARROW_KEYCODE) {
            window.location.href = getPrevUrl();
        } else if (keycode === RIGHT_ARROW_KEYCODE) {
            window.location.href = getNextUrl();
        }
    };

    var keyboardListener = false;
    $( document ).ready(() => {
        if (keyboardListener === false) {
            document.addEventListener('keydown', initPageNav)
            keyboardListener = true;
        }
    });
</script>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2019, The SciPy community.
      Last updated on Nov 29, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
<div class="footer-area footer--light">
  <div class="footer-big">
    <!-- start .container -->
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-sm-12">
          <div class="footer-widget">
            <div class="widget-about">
              <img src="../_static/images/numpy_logo.svg" alt="NumPy logo" class="img-fluid">
              <p>NumPy is the fundamental package needed for scientific computing with Python.</p>
              <ul class="contact-details">
                <li>
                  <span class="icon-envelope-open"></span>
                  <a href="https://mail.python.org/mailman/listinfo/numpy-discussion">
                    Mailing list
                  </a>
                </li>
              </ul>
            </div>
          </div>
          <!-- Ends: .footer-widget -->
        </div>
        <!-- end /.col-md-4 -->
        <div class="col-md-3 col-sm-4">
          <div class="footer-widget">
            <div class="footer-menu footer-menu--1">
              <h4 class="footer-widget-title">About us</h4>
              <ul>
                <li>
                  <a href="#">Our history</a>
                </li>
                <li>
                  <a href="#">Ecosystem</a>
                </li>
                <li>
                  <a href="#">Roadmap</a>
                </li>
                <li>
                  <a href="#">Team</a>
                </li>
              </ul>
            </div>
            <!-- end /.footer-menu -->
          </div>
          <!-- Ends: .footer-widget -->
        </div>
        <!-- end /.col-md-3 -->

        <div class="col-md-3 col-sm-4">
          <div class="footer-widget">
            <div class="footer-menu">
              <h4 class="footer-widget-title">Community</h4>
              <ul>
                <li>
                  <a href="#">Blog</a>
                </li>
                <li>
                  <a href="#">Contributing</a>
                </li>
                <li>
                  <a href="#">Code of conduct</a>
                </li>
                <li>
                  <a href="#">Community survey</a>
                </li>
              </ul>
            </div>
            <!-- end /.footer-menu -->
          </div>
          <!-- Ends: .footer-widget -->
        </div>
        <!-- end /.col-lg-3 -->

        <div class="col-md-3 col-sm-4">
          <div class="footer-widget">
            <div class="footer-menu no-padding">
              <h4 class="footer-widget-title">Learning &  Documentation</h4>
              <ul>
                <li>
                  <a href="#">User guide</a>
                </li>
                <li>
                  <a href="#">API reference</a>
                </li>
                <li>
                  <a href="#">Release notes</a>
                </li>
                <li>
                  <a href="#">Tutorials</a>
                </li>
                <li>
                  <a href="#">Videos</a>
                </li>
                <li>
                  <a href="#">Books</a>
                </li>
                <li>
                  <a href="#">Courses</a>
                </li>
              </ul>
            </div>
            <!-- end /.footer-menu -->
          </div>
          <!-- Ends: .footer-widget -->
        </div>
        <!-- Ends: .col-lg-3 -->

      </div>
      <!-- end /.row -->
    </div>
    <!-- end /.container -->
  </div>
  <!-- end /.footer-big -->

  <div class="mini-footer">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="copyright-text">
            <p>&copy; <span id="year"></span>
              <a href="#">NumPy Developers</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  </body>
</html>